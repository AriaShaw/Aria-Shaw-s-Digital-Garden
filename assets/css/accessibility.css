/* Accessibility Improvements for PageSpeed */

/* 1. Links must be distinguishable without color - add underlines */
a {
  text-decoration: underline;
  text-decoration-skip-ink: auto;
}

/* Keep buttons without underlines */
button,
.btn,
.button,
[role="button"] {
  text-decoration: none !important;
}

/* Navigation links - add underline on hover at minimum */
nav a,
.site-title a,
header a {
  text-decoration: none;
}

nav a:hover,
nav a:focus,
.site-title a:hover,
header a:focus {
  text-decoration: underline;
}

/* ========================================
   Home Page Exceptions
   ======================================== */

/* Home page heading links - no underline by default */
.home-page h1 a,
.home-page h2 a,
.home-page h3 a,
.home-page .home-site-title a,
.home-page .home-nav-links a {
  text-decoration: none !important;
}

/* Home page heading links - underline on hover */
.home-page h1 a:hover,
.home-page h2 a:hover,
.home-page h3 a:hover,
.home-page .home-site-title a:hover,
.home-page .home-nav-links a:hover,
.home-page .home-nav-links a:focus {
  text-decoration: underline !important;
}

/* Home page footer links */
.home-page .home-footer a {
  text-decoration: none !important;
}

.home-page .home-footer a:hover {
  text-decoration: underline !important;
}

/* 2. Improve color contrast for code blocks */
/* Override syntax highlighting colors with better contrast */
.highlight .c,    /* Comments - was low contrast yellow */
.highlight .cm,
.highlight .c1 {
  color: #6a737d !important;  /* Gray with better contrast */
  background-color: transparent !important;
}

.highlight pre,
.highlight code {
  background-color: #f6f8fa !important;  /* Light background */
  color: #24292e !important;  /* Dark text */
}

/* Yellow highlights in code - improve contrast */
span.c {
  background-color: #fff3cd !important;  /* Lighter yellow background */
  color: #856404 !important;  /* Dark brown text for contrast */
  padding: 2px 4px;
  border-radius: 3px;
}

/* Built-in names (nb) - commands like install, sudo, cd, grep */
/* Default blue (#0086b3) has insufficient contrast on light background */
.highlight .nb,
.highlight .bp {
  color: #005cc5 !important;  /* Darker blue for better contrast (WCAG AA compliant) */
  font-weight: 500 !important;  /* Slightly bolder for better readability */
}

/* 3. Minimum touch target sizes - 48x48px */
/* Ensure all interactive elements meet WCAG 2.1 AAA */
/* Exclude product-box-cta, inline-simple-cta, toc-link, and task-list checkboxes */
a:not(.product-box-cta):not(.inline-simple-cta):not(.toc-link),
button,
input[type="submit"],
input[type="button"],
input[type="checkbox"]:not(.task-list-item-checkbox),
input[type="radio"],
select,
.clickable {
  min-height: 48px;
  min-width: 48px;
  padding: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* Task list checkboxes should remain normal size */
.task-list-item-checkbox {
  min-height: auto !important;
  min-width: auto !important;
  padding: 0 !important;
  display: inline !important;
  width: 16px !important;
  height: 16px !important;
  margin-right: 8px !important;
  vertical-align: middle !important;
}

/* Exception for inline text links - reduce padding to prevent spacing stacking */
/* Exclude TOC links to prevent layout conflicts */
p a,
li:not(.toc-item) a,
td a {
  min-height: auto !important;
  min-width: auto !important;
  padding: 8px 4px !important;
  line-height: inherit !important;
  display: inline !important;
}

/* Mobile: Use negative margin trick to expand touch area without visual spacing */
@media (max-width: 768px) {
  p a,
  li:not(.toc-item) a,
  td a {
    padding: 10px 6px !important;
    margin: -10px -6px !important;
    /* Negative margin offsets the padding, maintaining visual layout */
    /* But the actual touch target is 44px+ as per WCAG 2.1 AAA */
    min-height: 44px !important;
    display: inline !important;
    line-height: inherit !important;
  }

  /* Navigation and standalone links get full touch targets */
  nav a,
  .breadcrumbs a,
  .home-nav-links a {
    min-height: 44px !important;
    min-width: 44px !important;
    padding: 10px 16px !important;
    margin: 0 !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
}

/* Code copy buttons - styles are in head-custom.html */
button[data-clipboard-target] {
  min-height: 48px;
  min-width: 48px;
  padding: 12px;
  cursor: pointer;
}

/* Calculator buttons and CTA links - use inline-block for better text alignment */
.calculate-btn,
.cta-primary,
.cta-secondary,
.cta-button {
  min-height: 48px;
  padding: 14px 28px;
  display: inline-block !important;
  line-height: 1.2;
  vertical-align: middle;
}

/* Product box CTA buttons - override flex layout to prevent text misalignment */
.product-box-cta {
  display: inline-block !important;
  /* Reset flex properties that cause vertical misalignment */
  align-items: initial !important;
  justify-content: initial !important;
  /* Ensure proper text centering with adequate vertical padding */
  line-height: 1.4 !important;
  text-align: center !important;
  /* Adjusted padding for perfect vertical centering: (48px min-height - ~20px text) / 2 = ~14px top/bottom */
  padding: 14px 24px !important;
  /* Ensure minimum touch target */
  min-height: 48px !important;
  min-width: auto !important;
  /* Ensure box-sizing includes padding in height calculation */
  box-sizing: border-box !important;
}

/* Inline simple CTA buttons - same fix as product-box-cta */
.inline-simple-cta {
  display: inline-block !important;
  align-items: initial !important;
  justify-content: initial !important;
  line-height: 1.4 !important;
  text-align: center !important;
  padding: 10px 16px !important;
  min-height: 44px !important;
  min-width: auto !important;
  box-sizing: border-box !important;
}

/* Floating TOC toggle */
.toc-toggle {
  min-height: 48px;
  min-width: 48px;
  padding: 12px;
}

/* 4. Form labels for accessibility */
/* Ensure all inputs have visible or aria labels */
input[type="checkbox"]:not([aria-label]):not([aria-labelledby]) {
  /* Add visual focus indicator for unlabeled checkboxes */
  outline: 2px solid transparent;
  outline-offset: 2px;
}

input[type="checkbox"]:focus {
  outline-color: #0969da;
}

/* Task list checkboxes - these are decorative, hide from screen readers */
.task-list-item-checkbox[disabled] {
  aria-hidden: true;
}

/* 5. Focus indicators for keyboard navigation */
a:focus,
button:focus,
input:focus,
select:focus,
textarea:focus {
  outline: 2px solid #0969da;
  outline-offset: 2px;
}

/* 6. Improve heading contrast */
h1, h2, h3, h4, h5, h6 {
  color: #24292e;  /* Ensure sufficient contrast */
}

/* 7. Mobile font size minimum 16px to prevent zoom */
@media (max-width: 768px) {
  body {
    font-size: 16px;
  }

  p, li, td, th {
    font-size: 16px;
  }

  small {
    font-size: 14px;  /* Minimum for small text */
  }
}

/* 8. Full-width layout for default.html (guides, tools, content pages) */
.full-width-layout .wrapper {
  width: 100% !important;
  max-width: 960px !important;
  margin: 0 auto !important;
}

.full-width-layout header {
  display: none !important;
  border: none !important;
}

.full-width-layout section {
  width: 100% !important;
  float: none !important;
  padding: 20px !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
}

/* Footer base styles - but exclude professional-footer from forced styles */
.full-width-layout footer:not(.professional-footer) {
  width: 100% !important;
  float: none !important;
  text-align: center !important;
  padding: 20px !important;
  border-top: none !important;
  margin-top: 40px !important;
}

/* Professional footer should maintain its own styles */
.full-width-layout footer.professional-footer {
  width: 100% !important;
  float: none !important;
  text-align: left !important;  /* Left align, not center */
  padding: 0 !important;  /* No padding - let internal containers handle it */
  border-top: none !important;
  margin-top: 0 !important;  /* No extra margin - component handles spacing */
  min-height: auto !important;  /* Allow full height */
  height: auto !important;  /* Allow natural height */
  max-height: none !important;  /* Remove any height restrictions */
  overflow: visible !important;  /* Ensure all content is visible */
}

/* Ensure footer children are visible */
.full-width-layout footer.professional-footer * {
  display: block !important;
  visibility: visible !important;
}

/* But maintain grid/flex layouts where needed */
.full-width-layout footer.professional-footer .footer-container,
.full-width-layout footer.professional-footer .footer-bottom-container,
.full-width-layout footer.professional-footer .footer-social-links {
  display: grid !important;
}

.full-width-layout footer.professional-footer .footer-social-links,
.full-width-layout footer.professional-footer .footer-bottom-container {
  display: flex !important;
}

/* 9. Optimized post layout - compact sidebar with taller TOC */
.post-layout .wrapper {
  width: 100% !important;
  max-width: 1200px !important;
  margin: 0 auto !important;
  padding: 0 20px !important;
}

.post-layout .post-sidebar {
  width: 220px !important;
  position: fixed !important;
  left: calc((100vw - 1200px) / 2) !important;
  top: 20px !important;
  padding: 0 !important;
  max-height: calc(100vh - 40px) !important;
  overflow-y: auto !important;
  border: none !important;
  z-index: 100 !important;
}

.post-layout section {
  width: 100% !important;
  max-width: 900px !important;
  margin-left: auto !important;
  margin-right: 0 !important;
  padding: 20px 20px 20px 40px !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
}

.post-layout footer {
  width: 100% !important;
  max-width: 900px !important;
  margin-left: auto !important;
  margin-right: 0 !important;
  padding: 20px 20px 20px 40px !important;
  border-top: none !important;
  margin-top: 40px !important;
  position: relative !important;
  z-index: 1 !important;
}

/* Increase TOC height for better preview */
.post-layout .floating-toc {
  max-height: calc(100vh - 60px) !important;
  position: sticky !important;
  top: 20px !important;
}

.post-layout .toc-nav {
  max-height: calc(100vh - 140px) !important;
}

/* Limit image size in articles and content pages - Desktop */
.post-layout section img,
.full-width-layout section img {
  max-width: 100% !important;
  max-height: 600px !important;
  width: auto !important;
  height: auto !important;
  display: block !important;
  margin: 20px auto !important;
  object-fit: contain !important;
}

/* For very large images (diagrams, flowcharts), limit both width and height - Desktop */
.post-layout section img[src*="diagram"],
.post-layout section img[src*="architecture"],
.post-layout section img[src*="flow"],
.full-width-layout section img[src*="diagram"],
.full-width-layout section img[src*="architecture"],
.full-width-layout section img[src*="flow"] {
  max-width: 700px !important;
  max-height: 500px !important;
}

@media (max-width: 768px) {
  .post-layout .post-sidebar {
    position: static !important;
    width: 100% !important;
    float: none !important;
  }

  .post-layout section {
    width: 100% !important;
    float: none !important;
    margin-left: 0 !important;
  }

  .post-layout footer {
    width: 100% !important;
    float: none !important;
    margin-left: 0 !important;
  }

  /* Images on mobile - scale to fit container, maintain aspect ratio */
  .post-layout section img,
  .full-width-layout section img {
    max-width: 100% !important;
    width: auto !important;
    height: auto !important;
    max-height: none !important;
    margin: 15px auto !important;
    display: block !important;
  }

  /* Override diagram size limits on mobile - also scale to fit */
  .post-layout section img[src*="diagram"],
  .post-layout section img[src*="architecture"],
  .post-layout section img[src*="flow"],
  .full-width-layout section img[src*="diagram"],
  .full-width-layout section img[src*="architecture"],
  .full-width-layout section img[src*="flow"] {
    max-width: 100% !important;
    width: auto !important;
    max-height: none !important;
  }

  /* ============================================================
     Jekyll Theme Minimal Mobile Overrides (from style.scss)
     ============================================================ */

  /* CRITICAL: Prevent horizontal scrolling completely */
  html {
    width: 100% !important;
    overflow-x: hidden !important;
    box-sizing: border-box !important;
  }

  /* Force full-width layout on all pages - override theme defaults */
  body {
    padding: 0 !important;
    margin: 0 !important;
    font-size: 16px !important;
    width: 100% !important;
    max-width: 100% !important;
    overflow-x: hidden !important;
    box-sizing: border-box !important;
    position: relative !important;
  }

  .wrapper,
  .home-wrapper {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    box-sizing: border-box !important;
    overflow-x: hidden !important;
  }

  /* Full-width sections - override 270px sidebar + 500px content */
  header, section, footer,
  .home-header, .home-content, .home-footer {
    width: 100% !important;
    max-width: 100% !important;
    float: none !important;
    position: static !important;
    padding: 15px !important;
    border: none !important;
    margin: 0 !important;
    left: 0 !important;
    right: 0 !important;
    box-sizing: border-box !important;
  }

  /* Hide TOC sidebar on mobile */
  .post-sidebar,
  .post-layout .post-sidebar,
  .floating-toc {
    display: none !important;
  }

  /* Full-width layout header should be hidden on mobile */
  .full-width-layout header {
    display: none !important;
  }

  /* Prevent text truncation */
  h1, h2, h3, h4, h5, h6, p, li, td, th {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
  }

  /* Fluid typography - scales smoothly across all mobile devices */
  /* Uses clamp() for responsive font sizes without media query breakpoints */
  body {
    font-size: clamp(14px, 4vw, 16px) !important;
    line-height: 1.6 !important;
  }

  h1 {
    font-size: clamp(22px, 6vw, 28px) !important;
    line-height: 1.2 !important;
    margin: clamp(12px, 3vw, 16px) 0 !important;
  }

  h2 {
    font-size: clamp(18px, 5vw, 24px) !important;
    line-height: 1.3 !important;
    margin: clamp(10px, 2.5vw, 14px) 0 !important;
  }

  h3 {
    font-size: clamp(16px, 4.5vw, 20px) !important;
    line-height: 1.3 !important;
    margin: clamp(8px, 2vw, 12px) 0 !important;
  }

  /* Better paragraph spacing */
  p {
    margin-bottom: 1.2em !important;
    line-height: 1.65 !important;
  }

  /* Home page specific fixes - HORIZONTAL navigation on mobile */
  .home-wrapper {
    width: 100% !important;
    max-width: 100% !important;
    padding: 0 !important;
    box-sizing: border-box !important;
  }

  .home-header {
    padding: 15px !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }

  .home-nav-container {
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 15px !important;
    width: 100% !important;
  }

  .home-site-title {
    font-size: 20px !important;
    margin: 0 !important;
    width: 100% !important;
  }

  /* CRITICAL: Force horizontal layout for Guides/Tools/Products */
  .home-nav-links {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: wrap !important;
    justify-content: flex-start !important;
    gap: 15px 20px !important;
    width: 100% !important;
  }

  .home-nav-links a {
    flex: 0 0 auto !important;
    padding: 8px 12px !important;
    margin: 0 !important;
    white-space: nowrap !important;
  }

  /* Containers must not add extra width */
  section,
  .home-content,
  .post-layout section,
  .full-width-layout section {
    padding: 15px !important;
    margin: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    overflow-x: hidden !important;
  }

  /* CRITICAL: Images must scale down to fit container width (minus padding) */
  img {
    max-width: 100% !important;
    width: auto !important;
    height: auto !important;
    display: block !important;
    margin: 15px auto !important;
    padding: 0 !important;
    box-sizing: border-box !important;
  }

  /* Ensure ALL elements stay within container */
  * {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Code blocks must fit container, not viewport */
  pre, code {
    max-width: 100% !important;
    overflow-x: auto !important;
    word-wrap: normal !important;
    box-sizing: border-box !important;
  }

  /* Add visual indicator for code blocks */
  pre {
    border-left: 3px solid #0969da !important;
    padding-left: 12px !important;
    background: #f6f8fa !important;
    border-radius: 6px !important;
  }

  /* Ensure parent containers don't cause page-level horizontal scroll */
  .post-layout section,
  .full-width-layout section,
  .home-content {
    overflow-x: hidden !important;
  }

  /* Responsive tables - Card layout for better mobile UX */
  table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 15px 0 !important;
    font-size: 14px !important;
  }

  /* Small tables with 2-3 columns: keep traditional layout but scrollable */
  table:not(.card-table) {
    display: block !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    border: 1px solid #e1e4e8 !important;
    border-radius: 6px !important;
  }

  /* Large tables: convert to card layout for readability */
  table.card-table {
    display: block !important;
    border: 0 !important;
  }

  table.card-table thead {
    display: none !important;
  }

  table.card-table tbody {
    display: block !important;
  }

  table.card-table tr {
    display: block !important;
    margin-bottom: 15px !important;
    border: 1px solid #e1e4e8 !important;
    border-radius: 6px !important;
    padding: 12px !important;
    background: #f6f8fa !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important;
  }

  table.card-table td {
    display: flex !important;
    justify-content: space-between !important;
    padding: 8px 0 !important;
    border: 0 !important;
    border-bottom: 1px solid #e1e4e8 !important;
    text-align: right !important;
  }

  table.card-table td:last-child {
    border-bottom: 0 !important;
  }

  /* Add data labels using data-label attribute */
  table.card-table td::before {
    content: attr(data-label) !important;
    font-weight: 600 !important;
    color: #24292e !important;
    text-align: left !important;
    margin-right: 10px !important;
  }

  /* Scroll indicator for horizontal scrolling tables */
  table:not(.card-table)::after {
    content: '' !important;
    position: absolute !important;
    right: 0 !important;
    top: 0 !important;
    bottom: 0 !important;
    width: 30px !important;
    background: linear-gradient(to left, rgba(255,255,255,0.9), transparent) !important;
    pointer-events: none !important;
  }

  /* CTA buttons should be full-width on mobile for better UX */
  .product-box-cta,
  .inline-simple-cta {
    width: calc(100% - 30px) !important;
    max-width: calc(100% - 30px) !important;
    display: block !important;
    text-align: center !important;
    padding: 14px 20px !important;
    margin: 10px 15px !important;
    box-sizing: border-box !important;
  }

  /* Breadcrumbs should wrap */
  nav.breadcrumbs {
    width: calc(100% - 30px) !important;
    overflow-x: auto !important;
    white-space: nowrap !important;
    font-size: 14px !important;
    margin: 0 15px !important;
    box-sizing: border-box !important;
  }

  /* Prevent paragraphs and divs from extending beyond viewport */
  p, div, ul, ol, li {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
}

/* Extra small devices (phones, less than 480px) */
@media (max-width: 480px) {
  body {
    font-size: 16px !important;
  }

  h1 {
    font-size: 22px !important;
  }

  h2 {
    font-size: 18px !important;
  }

  h3 {
    font-size: 16px !important;
  }

  .home-wrapper,
  .home-content,
  section {
    padding: 10px !important;
  }

  .home-nav-links {
    flex-direction: column !important;
    gap: 10px !important;
    align-items: flex-start !important;
  }
}

