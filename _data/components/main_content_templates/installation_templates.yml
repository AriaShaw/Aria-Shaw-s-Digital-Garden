# ============================================================================
# INSTALLATION GUIDE MAIN CONTENT TEMPLATE
# ============================================================================
# Description: Generate installation guide main content for Odoo OS installation pages
# Template ID: installation
# Version: 1.0
# ============================================================================

template_info:
  template_id: installation
  description: "OS-based Odoo installation guide main content"
  version: "1.0"
  variables_required:
    - odoo_version
    - os_name
    - os_version
    - os_slug

# Main template content
template: |
  Installing Odoo {odoo_version} on {os_name} {os_version} from source code provides complete control over your ERP infrastructure—from database configuration through module selection to upgrade timing. Unlike managed hosting that abstracts infrastructure behind opaque control panels, source installation gives you direct access to configuration files, PostgreSQL tuning parameters, and system resources that determine whether your Odoo instance handles ten users or one hundred.

  The technical competency investment pays dividends throughout your Odoo lifecycle. When performance issues emerge, you diagnose PostgreSQL query patterns rather than filing support tickets. When security updates release, you apply them on your schedule after testing in staging environments. When module conflicts break functionality, you inspect Python stack traces and patch code directly. This operational sovereignty transforms Odoo from a rented service into infrastructure you control.

  ## Server Requirements and Architecture Decisions

  Installing Odoo {odoo_version} on {os_name} {os_version} requires careful consideration of your architecture before executing installation commands. The single-server deployment documented here suits businesses with 10-50 concurrent users and handles typical ERP workloads—accounting, inventory management, CRM, sales orders—without performance degradation. If your team exceeds 50 users or processes high-volume transactions (e-commerce with thousands of daily orders, manufacturing with complex bill-of-materials calculations), you need separated application and database tiers from the start.

  {os_name_benefits}

  The installation process follows a specific sequence because later steps depend on earlier components. PostgreSQL must exist before you create the Odoo database user. Python dependencies must install before you clone Odoo's source code. System users must exist before you assign file ownership. Skipping steps or reordering them creates cryptic permission errors and missing library failures that waste hours of troubleshooting time.

  ## Step-by-Step Installation Walkthrough

  The deployment begins with system preparation. Connect to your server via SSH and update the package repositories to current versions. {os_name} {os_version} ships with PostgreSQL {postgresql_version}, which provides the JSON indexing and full-text search capabilities Odoo requires for efficient record filtering and inventory lookups. Install PostgreSQL first, create a dedicated database user named 'odoo' with superuser privileges, and initialize an empty database that Odoo will populate during first launch.

  Python {python_version} serves as Odoo's runtime environment. {os_name}'s default repositories include the correct version along with essential development headers and build tools. Install the full Python development package, not just the interpreter, because Odoo's requirements include C-extension libraries like lxml and Pillow that compile native code during installation. Missing gcc or python-dev packages cause installation failures with unclear error messages.

  wkhtmltopdf handles PDF generation for invoices, reports, and shipping labels. Odoo embeds this external tool through system calls, so installation location and permissions matter. Download the version specifically packaged for {os_name} {os_version} from wkhtmltopdf.org, not your distribution's repositories—the packaged version includes Qt patches that fix rendering issues with complex CSS layouts and ensure consistent page breaks in multi-page reports.

  Create a system user named 'odoo' to run the application process. This dedicated user provides security isolation—if attackers compromise the Odoo process, they gain only 'odoo' user permissions, not root access to your entire system. Configure this user without shell access and with a locked password, then clone Odoo's source repository into /opt/odoo/odoo{odoo_version}/ with this user as the owner.

  The configuration file at /etc/odoo/odoo.conf contains parameters that determine Odoo's runtime behavior. Set the master password (admin_passwd) to a strong random string—this password protects database creation, backup restoration, and module installation operations. Configure worker processes using the formula (CPU cores × 2) + 1 to balance concurrency with memory usage. Set proxy_mode = True if you'll add NGINX reverse proxy later, which most production deployments require for SSL termination.

  The systemd service configuration ensures Odoo starts automatically after server reboots and restarts after crashes. Create /etc/systemd/system/odoo.service with proper User, Group, and ExecStart directives pointing to Odoo's binary and configuration file. Enable the service with systemctl enable, then start it with systemctl start. Check status with systemctl status odoo—you should see "active (running)" and log entries showing successful database connection.

  ## Database Performance Tuning

  PostgreSQL's default configuration optimizes for minimal memory usage, not performance. Your Odoo database will execute thousands of queries daily—product searches, invoice generation, inventory updates—and default settings leave 90% of available RAM unused. Edit postgresql.conf to set shared_buffers = 25% of system RAM, effective_cache_size = 50% of system RAM, and work_mem = 16MB for complex query optimization.

  Maintenance tasks prevent performance degradation over time. Configure PostgreSQL to automatically vacuum deleted records, which accumulate as users edit and delete transactions. Enable autovacuum with aggressive settings: autovacuum_max_workers = 3, autovacuum_naptime = 10 seconds. Create a weekly cron job to run REINDEX DATABASE on your Odoo database, which rebuilds indexes fragmented by constant updates.

  ## Security Hardening

  The installation creates an accessible Odoo instance on port 8069, but production security requires multiple layers. Install NGINX as a reverse proxy to handle HTTPS termination, request filtering, and rate limiting. Configure NGINX to forward requests from port 443 to Odoo's port 8069, setting proxy_read_timeout to 600 seconds—Odoo's module installation and large report generation operations require several minutes to complete, and lower timeouts kill these requests prematurely.

  Let's Encrypt provides free SSL certificates with automated renewal. Install Certbot, run certification for your domain, and add a cron job for automatic renewal every 60 days. SSL certificates expire after 90 days, but renewing at 60 days provides safety margin for renewal failures or network issues.

  Firewall configuration requires precision. Use UFW (Uncomplicated Firewall) to allow SSH (port 22), HTTP (port 80), and HTTPS (port 443) inbound traffic. Block direct access to port 8069 from external networks—Odoo should only accept connections from NGINX's localhost proxy. This prevents attackers from bypassing your reverse proxy's security features and accessing Odoo's administrative interfaces directly.

  ## Backup Strategy

  Production deployments require automated, tested backups before you add real business data. Install the backup script from the Fortress Protection module, which performs PostgreSQL dumps with compression, copies filestore attachments, and syncs backups to off-site storage. Schedule daily backups at 2 AM when user activity minimizes, and retain 30 daily backups, 12 monthly backups, and 7 yearly backups.

  Test restoration procedures within the first week. Create a test instance, restore yesterday's backup, and verify all data loads correctly and modules function properly. Untested backups provide false security—you only discover corruption or missing steps when disaster strikes and recovery fails.

  ## Monitoring and Operational Visibility

  The free Odoo Health Monitor script tracks CPU usage, memory consumption, disk space, and PostgreSQL connection counts every 5 minutes. Configure alert thresholds at 80% CPU utilization and 500MB free memory—these provide early warning before performance degrades to user-visible levels. Log monitoring output to /var/log/odoo-health.log for historical analysis.

  Monitor disk space growth carefully. Odoo's filestore directory accumulates uploaded attachments, generated PDFs, and cached report images. Plan for 10-20GB growth annually for typical SMB usage, more for document-heavy workflows. Set up alerts when free space drops below 20% to prevent emergency cleanups during month-end processing.

  ## Post-Installation Verification

  Access Odoo through your browser at https://yourdomain.com. The first-access setup wizard prompts for master password verification, database creation, and initial module selection. Install at minimum: Sales, Inventory, and Accounting for business operations visibility. Add Website and E-commerce if you sell online. Skip unnecessary modules initially—you can install them later without disrupting operations.

  Create administrative and standard user accounts immediately. Don't use the default 'admin' user for daily operations—create a personal account with limited privileges and reserve 'admin' for system configuration and module installation. This separation prevents accidental configuration changes and provides audit trail clarity.

  The deployment time from SSH connection to operational Odoo instance takes 30-45 minutes for experienced administrators, 60-90 minutes for first-time installations. This time investment establishes infrastructure that supports business operations for years, not months. You built a production-grade foundation that handles growth from ten to one hundred users without architectural rebuilds—that scalability and control define digital sovereignty.

# Variable mappings (lookup tables)
variable_mappings:
  os_name_benefits:
    Ubuntu: |
      Ubuntu Server LTS releases receive five years of security updates and package stability guarantees, which means your Odoo installation avoids forced upgrades when you're focused on business operations rather than system administration. The distribution's widespread adoption ensures package availability and community troubleshooting resources—when you encounter issues, someone else has already documented the solution.

    Debian: |
      Debian's legendary stability comes from its rigorous package testing process, where software spends months in testing repositories before reaching stable releases. This conservative approach means your Odoo server won't experience package conflicts or dependency breakage from routine updates. The distribution's minimal default installation provides a clean foundation without unnecessary services consuming resources.

    CentOS: |
      CentOS provides enterprise-grade stability through its downstream relationship with Red Hat Enterprise Linux. The platform receives binary-compatible packages tested in RHEL production environments, giving you enterprise reliability without subscription costs. SELinux integration provides mandatory access controls that contain security breaches even if attackers compromise the Odoo process.

    "Rocky Linux": |
      Rocky Linux continues the CentOS tradition after Red Hat's strategic pivot, providing RHEL-compatible binaries maintained by the original CentOS founder. The distribution prioritizes stability and enterprise features, making it ideal for businesses requiring long-term support without vendor lock-in. The community-driven governance model ensures the platform serves user needs rather than corporate agendas.

    Fedora: |
      Fedora delivers cutting-edge package versions and rapid access to new PostgreSQL releases, Python versions, and system utilities. The distribution serves as upstream for RHEL, meaning innovations tested in Fedora production deployments eventually stabilize in enterprise distributions. This makes Fedora suitable for development environments and businesses comfortable with more frequent update cycles.
    
        # AWS cloud platforms
    "AWS EC2": |
      AWS EC2 provides enterprise-grade infrastructure with global data center presence across 30+ availability zones, enabling you to deploy Odoo instances close to your users for optimal latency. The platform's elastic compute model allows instant vertical scaling when your business grows, comprehensive monitoring through CloudWatch provides operational visibility without additional tools, and fine-grained IAM controls enforce least-privilege access to production resources.

    "AWS Lightsail": |
      AWS Lightsail simplifies cloud deployment with predictable monthly pricing that includes compute, storage, and data transfer—eliminating surprise costs that plague traditional cloud billing. The platform provides one-click instance provisioning, automatic snapshots for disaster recovery, and seamless migration paths to full EC2 when your infrastructure requirements outgrow Lightsail's simplified model. Integration with AWS services like RDS and CloudWatch extends capabilities without complexity.

    "AWS ECS Fargate": |
      AWS ECS Fargate delivers serverless container orchestration that eliminates infrastructure management overhead while maintaining full Docker compatibility. The platform automatically provisions compute resources based on your container specifications, handles patch management and security updates without downtime, and scales horizontally by launching additional task instances during traffic spikes. Integration with AWS services provides managed databases, secrets management, and enterprise-grade monitoring.

    # Google Cloud platforms
    "Google Cloud": |
      Google Cloud Platform leverages Google's global fiber network to deliver consistently low-latency connections between regions, ensuring responsive Odoo performance for distributed teams. The platform's custom machine types allow precise CPU-to-memory ratio optimization, reducing costs by matching compute resources exactly to your workload. Live migration technology updates hypervisors without rebooting instances, maintaining continuous availability during maintenance windows.

    "Google Cloud Run": |
      Google Cloud Run offers serverless container deployment that automatically scales Odoo from zero to thousands of instances based on actual traffic, eliminating capacity planning and reducing costs during low-usage periods. The platform's global load balancing distributes requests across regions for fault tolerance, while Cloud SQL integration provides managed PostgreSQL databases without manual tuning. Request-based billing charges only for actual compute time, making it cost-effective for variable workloads.

    # Azure
    Azure: |
      Microsoft Azure provides enterprise integration with Active Directory and Microsoft 365 environments, enabling single sign-on and unified identity management across your business applications. The platform's hybrid cloud capabilities support seamless connectivity to on-premises infrastructure, Azure Arc extends management controls to resources outside Azure, and extensive compliance certifications meet industry-specific regulatory requirements. Reserved instances offer significant discounts for predictable workloads.

    # Vultr platforms
    "Vultr VX1": |
      Vultr VX1 instances deliver latest-generation AMD EPYC processors and NVMe SSD storage at aggressive price points, providing performance-to-cost ratios that benefit SMB Odoo deployments. The platform's 25+ global data center locations enable compliance with data residency requirements, while hourly billing and instant provisioning support development workflows. Simple, transparent pricing eliminates complex cost calculations and billing surprises.

    "Vultr High Frequency": |
      Vultr High Frequency compute instances combine NVMe SSD storage with high-clock-speed processors optimized for single-threaded performance, accelerating database queries and transaction processing in Odoo deployments. The platform's dedicated CPU allocation eliminates noisy neighbor performance degradation, while consistent network speeds and included DDoS protection ensure reliable production operations. Straightforward monthly pricing with generous bandwidth allocations simplifies cost forecasting.

    # DigitalOcean
    DigitalOcean: |
      DigitalOcean emphasizes developer experience with intuitive control panels, comprehensive documentation, and predictable pricing that includes generous bandwidth allocations. The platform's managed databases eliminate PostgreSQL administration overhead, automated backups protect against data loss without manual intervention, and VPC networking provides private communication channels between resources. One-click application deployments and extensive marketplace offerings accelerate setup workflows.

    # Hetzner
    Hetzner: |
      Hetzner delivers European infrastructure with competitive pricing that includes generous bandwidth allocations and local data sovereignty for GDPR compliance. The platform's dedicated vCPU allocation ensures consistent performance without resource contention, while located-in-Germany and Finland data centers provide low-latency access for European users. Simple, transparent pricing without complex tier structures or hidden fees simplifies budget forecasting.

    # Linode
    Linode: |
      Linode combines straightforward pricing with enterprise-grade infrastructure, offering dedicated CPU instances that eliminate noisy neighbor performance issues at competitive price points. The platform's 11 global data center locations enable strategic geographic distribution, while comprehensive API coverage supports infrastructure automation and programmatic management. Free tier-based technical support and extensive documentation library reduce operational overhead.

    # Windows Server platforms
    Windows: |
      Windows Server 2022 provides enterprise-grade infrastructure with extended support through 2031, offering decade-long stability for business-critical Odoo deployments. The platform's native Active Directory integration enables centralized user management and single sign-on capabilities, while PowerShell automation and Group Policy controls streamline operational tasks across server fleets. Familiarity with Windows administration reduces learning curves for IT teams already managing Windows infrastructure, and graphical management tools complement command-line interfaces for administrators preferring visual configuration workflows.

    # Default fallback for unknown platforms
    default: |
      This platform provides a stable foundation for Odoo installation with long-term support and comprehensive documentation resources. The system's architecture ensures reliable dependency management and security updates throughout your Odoo deployment lifecycle, while established community resources provide troubleshooting guidance and operational best practices.

  postgresql_version:
    Ubuntu: "16"
    Debian: "16"
    CentOS: "15"
    "Rocky Linux": "15"
    Fedora: "16"
    Windows: "16"
    "AWS EC2": "16"
    "AWS Lightsail": "16"
    "AWS ECS Fargate": "16"
    "Google Cloud": "16"
    "Google Cloud Run": "16"
    Azure: "16"
    "Vultr VX1": "16"
    "Vultr High Frequency": "16"
    DigitalOcean: "16"
    Hetzner: "16"
    Linode: "16"
    default: "15"

# Computed variables (using expression evaluator)
computed_variables:
  python_version:
    expression: "int(odoo_version) >= 17 ? '3.11' : '3.10'"
