<!-- Simplified PSEO Content Renderer - Unified 4-Field Structure -->
<!-- All pages now use: introduction, main_content, conclusion (AI-generated) -->

{% assign data = include.page_data %}

<!-- Opening Map: Workflow visualization (after introduction) -->
{% for viz in data.visualizations %}
  {% if viz.placement_hint == "opening_map" and viz.mermaid_chart_syntax and viz.mermaid_chart_syntax != "" %}
  <div class="mermaid">
{{ viz.mermaid_chart_syntax }}
  </div>
  {% endif %}
{% endfor %}

<!-- Main Content (unified field for all content types) -->
{% if data.ai_generated_content.main_content and data.ai_generated_content.main_content != "" %}
<div class="main-content">
  {{ data.ai_generated_content.main_content | markdownify }}
</div>
{% endif %}

<!-- CTA: Mid Content (mid_guide, mid_content placement) -->
<!-- Note: Some pages (e.g., comparisons) embed CTAs directly in main_content via placeholder replacement -->
{% for asset in data.conversion_assets %}
  {% if asset.placement_hint == "mid_guide" or asset.placement_hint == "mid_content" or asset.placement_hint == "before_steps" %}
    {% include ctas/{{ asset.component_type }}.html
       copy=asset.generated_copy
       intent_type=data.metadata.intent_type
       location="mid_content" %}
  {% endif %}
{% endfor %}

<!-- CTA: Post Technical (post_technical placement) -->
{% for asset in data.conversion_assets %}
  {% if asset.placement_hint == "post_technical" or asset.placement_hint == "after_verification" %}
    {% include ctas/{{ asset.component_type }}.html
       copy=asset.generated_copy
       intent_type=data.metadata.intent_type
       location="post_technical" %}
  {% endif %}
{% endfor %}

<!-- CTA: Pre Conclusion (pre_conclusion placement) -->
{% for asset in data.conversion_assets %}
  {% if asset.placement_hint == "pre_conclusion" or asset.placement_hint == "after_conclusion" %}
    {% include ctas/{{ asset.component_type }}.html
       copy=asset.generated_copy
       intent_type=data.metadata.intent_type
       location="pre_conclusion" %}
  {% endif %}
{% endfor %}

<!-- Conclusion (unified field) -->
{% assign conclusion = data.ai_generated_content.conclusion | default: data.ai_generated_content.summary | default: data.ai_generated_content.final_thoughts %}
{% if conclusion and conclusion != "" %}
<div class="conclusion" style="margin-top: 3rem; padding-top: 2rem; border-top: 2px solid #e1e4e8;">
  <h2>Conclusion</h2>
  {{ conclusion | markdownify }}
</div>
{% endif %}

<!-- Next Steps Guide: Learning path visualization (after conclusion) -->
{% if data.visualizations %}
  {% for viz in data.visualizations %}
    {% if viz.placement_hint == "next_steps_guide" and viz.mermaid_chart_syntax and viz.mermaid_chart_syntax != "" %}
    <div class="mermaid">
{{ viz.mermaid_chart_syntax }}
    </div>
    {% endif %}
  {% endfor %}
{% endif %}
