<!-- PSEO Content Renderer - Intent-Type Aware Dynamic Content Assembly -->
<!-- This include handles the rendering of AI-generated content based on the page's intent_type -->

{% assign data = include.page_data %}

<!-- RESEARCHER INTENT: Deep analysis, trust-building, comprehensive comparisons -->
{% if data.metadata.intent_type == "researcher" %}

  <!-- Sovereignty Analysis (if present) -->
  {% if data.ai_generated_content.sovereignty_analysis and data.ai_generated_content.sovereignty_analysis != "" %}
  <div class="sovereignty-analysis">
    <h2>Digital Sovereignty Analysis</h2>
    <div class="analysis-content">
      {{ data.ai_generated_content.sovereignty_analysis | markdownify }}
    </div>
  </div>
  {% endif %}

  <!-- Feature Comparison (if present in static_data) -->
  {% if data.static_data.feature_comparison %}
  <div class="feature-comparison">
    <h2>Feature Comparison</h2>
    <table style="width: 100%; border-collapse: collapse; margin: 1.5rem 0;">
      <thead>
        <tr style="background: #f6f8fa; border-bottom: 2px solid #d1d5da;">
          <th style="padding: 0.75rem; text-align: left;">Feature</th>
          {% for product in data.static_data.feature_comparison.products %}
          <th style="padding: 0.75rem; text-align: center;">{{ product.name }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for feature in data.static_data.feature_comparison.features %}
        <tr style="border-bottom: 1px solid #e1e4e8;">
          <td style="padding: 0.75rem; font-weight: 500;">{{ feature.name }}</td>
          {% for score in feature.scores %}
          <td style="padding: 0.75rem; text-align: center;">{{ score }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}

  <!-- Detailed Analysis Section -->
  {% if data.ai_generated_content.detailed_analysis and data.ai_generated_content.detailed_analysis != "" %}
  <div class="detailed-analysis">
    <h2>Detailed Analysis</h2>
    {{ data.ai_generated_content.detailed_analysis | markdownify }}
  </div>
  {% endif %}

<!-- PRACTITIONER INTENT: Step-by-step guides, actionable instructions, technical details -->
{% elsif data.metadata.intent_type == "practitioner" %}

  <!-- Step-by-Step Guide -->
  {% if data.ai_generated_content.step_by_step_guide and data.ai_generated_content.step_by_step_guide != "" %}
  <div class="implementation-guide">
    <h2>Implementation Guide</h2>
    {{ data.ai_generated_content.step_by_step_guide | markdownify }}
  </div>
  {% endif %}

  <!-- Code Snippets / Scripts (if present) -->
  {% if data.ai_generated_content.docker_compose_generator and data.ai_generated_content.docker_compose_generator != "" %}
  <div class="code-section">
    <h3>Docker Compose Configuration</h3>
    <pre style="background: #f6f8fa; padding: 1rem; border-radius: 6px; overflow-x: auto;"><code>{{ data.ai_generated_content.docker_compose_generator }}</code></pre>
  </div>
  {% endif %}

  {% if data.ai_generated_content.nginx_config_snippet and data.ai_generated_content.nginx_config_snippet != "" %}
  <div class="code-section">
    <h3>Nginx Configuration</h3>
    <pre style="background: #f6f8fa; padding: 1rem; border-radius: 6px; overflow-x: auto;"><code>{{ data.ai_generated_content.nginx_config_snippet }}</code></pre>
  </div>
  {% endif %}

  <!-- Technical Specifications (if present in static_data) -->
  {% if data.static_data.server_specs %}
  <div class="server-specs">
    <h2>Server Specifications</h2>
    <table style="width: 100%; border-collapse: collapse; margin: 1.5rem 0;">
      <thead>
        <tr style="background: #f6f8fa; border-bottom: 2px solid #d1d5da;">
          <th style="padding: 0.75rem; text-align: left;">Plan</th>
          <th style="padding: 0.75rem; text-align: center;">vCPUs</th>
          <th style="padding: 0.75rem; text-align: center;">RAM (GB)</th>
          <th style="padding: 0.75rem; text-align: center;">Storage (GB)</th>
          <th style="padding: 0.75rem; text-align: right;">Price</th>
        </tr>
      </thead>
      <tbody>
        {% for spec in data.static_data.server_specs %}
        <tr style="border-bottom: 1px solid #e1e4e8;">
          <td style="padding: 0.75rem; font-weight: 500;">{{ spec.plan }}</td>
          <td style="padding: 0.75rem; text-align: center;">{{ spec.vcpus }}</td>
          <td style="padding: 0.75rem; text-align: center;">{{ spec.ram_gb }}</td>
          <td style="padding: 0.75rem; text-align: center;">{{ spec.storage_gb }}</td>
          <td style="padding: 0.75rem; text-align: right;">${{ spec.price_eur }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}

  <!-- Common Mistakes / Troubleshooting -->
  {% if data.ai_generated_content.common_mistakes and data.ai_generated_content.common_mistakes != "" %}
  <div class="troubleshooting" style="background: #fff5f5; border-left: 4px solid #d73a49; padding: 1.5rem; margin: 2rem 0;">
    <h3 style="margin-top: 0; color: #d73a49;">Common Mistakes to Avoid</h3>
    {{ data.ai_generated_content.common_mistakes | markdownify }}
  </div>
  {% endif %}

<!-- DECIDER INTENT: ROI focus, business outcomes, calculator tools -->
{% elsif data.metadata.intent_type == "decider" %}

  <!-- TCO Analysis -->
  {% if data.ai_generated_content.cost_analysis_text and data.ai_generated_content.cost_analysis_text != "" %}
  <div class="tco-analysis">
    <h2>Total Cost of Ownership Analysis</h2>
    {{ data.ai_generated_content.cost_analysis_text | markdownify }}
  </div>
  {% endif %}

  <!-- ROI Calculator (if present in static_data) -->
  {% if data.static_data.tco_breakdown %}
  <div class="tco-breakdown">
    <h2>Cost Breakdown</h2>
    <table style="width: 100%; border-collapse: collapse; margin: 1.5rem 0; background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
      <thead>
        <tr style="background: #267CB9; color: white;">
          <th style="padding: 1rem; text-align: left;">Cost Category</th>
          <th style="padding: 1rem; text-align: right;">Amount</th>
        </tr>
      </thead>
      <tbody>
        {% for item in data.static_data.tco_breakdown %}
        <tr style="border-bottom: 1px solid #e1e4e8;">
          <td style="padding: 0.75rem;">{{ item.category }}</td>
          <td style="padding: 0.75rem; text-align: right; font-weight: 600;">${{ item.amount }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}

  <!-- Business Value Proposition -->
  {% if data.ai_generated_content.business_value and data.ai_generated_content.business_value != "" %}
  <div class="business-value" style="background: linear-gradient(135deg, #f6f8fa 0%, #ffffff 100%); border: 2px solid #267CB9; border-radius: 8px; padding: 2rem; margin: 2rem 0;">
    <h2 style="margin-top: 0; color: #267CB9;">Business Value</h2>
    {{ data.ai_generated_content.business_value | markdownify }}
  </div>
  {% endif %}

{% endif %}

<!-- Conclusion (common to all intent types) -->
{% if data.ai_generated_content.conclusion and data.ai_generated_content.conclusion != "" %}
<div class="conclusion" style="margin-top: 3rem; padding-top: 2rem; border-top: 2px solid #e1e4e8;">
  <h2>Conclusion</h2>
  {{ data.ai_generated_content.conclusion | markdownify }}
</div>
{% endif %}
